import{_ as I,l as D,n as h,p as k,q as E,r as s,o as v,h as H,d as F,e as l,w as a,f as g,s as Y,F as R,i as K,b as N,E as q,v as M,m as j}from"./index-38646804.js";const z=D({name:"user",isRouter:!0,isComponent:!1,setup(){const{proxy:e}=j(),t=h([{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"gender",label:"性别"},{prop:"birth",label:"出生日期",width:200},{prop:"addr",label:"地址",width:320}]);let V=k([]);const d=h({total:0,page:1,name:""}),$=r=>{d.page=r,m(d)},m=async r=>{let _=await e.$api.getUserData(r);V.value=_.list.map(o=>(o.gender=o.sex===0?"女":"男",o)),r.total=_.count},u=h({keyword:""}),f=()=>{d.name=u.keyword,m(d)},n=k(!1),b=r=>{q.confirm("关闭窗口将不会保存所编辑信息，确认关闭吗?").then(()=>{r(),e.$refs.userFormRef.resetFields()}).catch(()=>{})},i=h({name:"",age:"",sex:"",birth:"",addr:""}),C=()=>{e.$refs.userFormRef.validate(async r=>{r?p.value==="add"?await e.$api.addUser(i)&&(e.$refs.userFormRef.resetFields(),n.value=!1,m(d)):(i.sex=i.sex==="男"?0:1,await e.$api.editUser(i)&&(e.$refs.userFormRef.resetFields(),n.value=!1,m(d))):M({showClose:!0,message:"请输入正确的内容",type:"error"})})},U=()=>{e.$refs.userFormRef.resetFields(),n.value=!1},p=k("add"),c=r=>{p.value="edit",n.value=!0,r.sex=r.sex===1?"男":"女",e.$nextTick(()=>{Object.assign(i,r)})},y=()=>{p.value="add",n.value=!0},w=r=>{q.confirm("确认永久删除该用户吗？").then(async()=>{await e.$api.deleteUser({id:r.id}),M({showClose:!0,message:"删除成功！",type:"success"}),m(d)}).catch(()=>{})};return E(()=>{m(d)}),{userData:V,tableHead:t,paramConfig:d,changePage:$,formInline:u,searchHandler:f,dialogVisible:n,dialogClose:b,formUser:i,onSubmit:C,cancelHandler:U,editHandler:c,addHandler:y,occupy:p,deleteHandler:w}}}),P={class:"action-contaienr"},S={class:"table-container"};function T(e,t,V,d,$,m){const u=s("el-button"),f=s("el-input"),n=s("el-form-item"),b=s("el-form"),i=s("el-table-column"),C=s("el-table"),U=s("el-pagination"),p=s("el-col"),c=s("el-row"),y=s("el-option"),w=s("el-select"),r=s("el-date-picker"),_=s("el-dialog");return v(),H(R,null,[F("div",P,[l(u,{type:"primary",onClick:e.addHandler},{default:a(()=>[g("+新增")]),_:1},8,["onClick"]),l(b,{inline:!0,model:e.formInline},{default:a(()=>[l(n,null,{default:a(()=>[l(f,{modelValue:e.formInline.keyword,"onUpdate:modelValue":t[0]||(t[0]=o=>e.formInline.keyword=o),placeholder:"请输入用户名",onKeyup:Y(e.searchHandler,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(n,null,{default:a(()=>[l(u,{type:"primary",onClick:e.searchHandler},{default:a(()=>[g("搜索")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),F("div",S,[l(C,{data:e.userData,style:{width:"100%"},height:"80vh"},{default:a(()=>[(v(!0),H(R,null,K(e.tableHead,o=>(v(),N(i,{key:o.prop,label:o.label,prop:o.prop,width:o.width?o.width:125},null,8,["label","prop","width"]))),128)),l(i,{fixed:"right",label:"操作","min-width":"180"},{default:a(o=>[l(u,{size:"small",onClick:B=>e.editHandler(o.row)},{default:a(()=>[g("编辑")]),_:2},1032,["onClick"]),l(u,{type:"danger",size:"small",onClick:B=>e.deleteHandler(o.row)},{default:a(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(U,{small:"",background:"",layout:"prev, pager, next",total:e.paramConfig.total,class:"mt-4",onCurrentChange:e.changePage},null,8,["total","onCurrentChange"])]),l(_,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=o=>e.dialogVisible=o),title:e.occupy==="add"?"新增用户":"编辑用户",width:"35%","before-close":e.dialogClose},{default:a(()=>[l(b,{inline:!0,model:e.formUser,ref:"userFormRef"},{default:a(()=>[l(c,null,{default:a(()=>[l(p,{span:12},{default:a(()=>[l(n,{label:"姓名",prop:"name",rules:[{required:!0,message:"请输入姓名"}]},{default:a(()=>[l(f,{modelValue:e.formUser.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.formUser.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,{span:12},{default:a(()=>[l(n,{label:"年龄",prop:"age",rules:[{required:!0,message:"请输入年龄"},{type:"number",message:"请输入数字"}]},{default:a(()=>[l(f,{modelValue:e.formUser.age,"onUpdate:modelValue":t[2]||(t[2]=o=>e.formUser.age=o),modelModifiers:{number:!0},placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:a(()=>[l(p,{span:11},{default:a(()=>[l(n,{label:"性别",prop:"sex",rules:[{required:!0,message:"请选择性别"}]},{default:a(()=>[l(w,{modelValue:e.formUser.sex,"onUpdate:modelValue":t[3]||(t[3]=o=>e.formUser.sex=o),placeholder:"请选择"},{default:a(()=>[l(y,{label:"女",value:"1"}),l(y,{label:"男",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(p,{span:13},{default:a(()=>[l(n,{label:"出生日期",prop:"birth",rules:[{required:!0,message:"请选择出生日期"}]},{default:a(()=>[l(r,{modelValue:e.formUser.birth,"onUpdate:modelValue":t[4]||(t[4]=o=>e.formUser.birth=o),type:"date",label:"出生日期",placeholder:"请选择",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:a(()=>[l(n,{label:"地址",prop:"addr",rules:[{required:!0,message:"请输入地址"}]},{default:a(()=>[l(f,{modelValue:e.formUser.addr,"onUpdate:modelValue":t[5]||(t[5]=o=>e.formUser.addr=o),type:"textarea",placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),l(c,{style:{"justify-content":"flex-end"}},{default:a(()=>[l(n,null,{default:a(()=>[l(u,{type:"primary",onClick:e.cancelHandler},{default:a(()=>[g("取消")]),_:1},8,["onClick"]),l(u,{type:"primary",onClick:e.onSubmit},{default:a(()=>[g("确定")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title","before-close"])],64)}const O=I(z,[["render",T]]);export{O as default};
