import{_ as I,l as D,p as E,n as y,q as C,r as s,o as k,h as $,d as F,e as l,w as a,f as _,s as Y,F as q,i as K,b as N,m as j,E as M,v as R}from"./index-31908423.js";const z=D({setup(){const{proxy:e}=j();E(()=>{m(d)});const t=y([{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"gender",label:"性别"},{prop:"birth",label:"出生日期",width:200},{prop:"addr",label:"地址",width:320}]);let h=C([]);const d=y({total:0,page:1,name:""}),v=r=>{d.page=r,m(d)},m=async r=>{let c=await e.$api.getUserData(r);h.value=c.list.map(o=>(o.gender=o.sex===0?"女":"男",o)),r.total=c.count},u=y({keyword:""}),f=()=>{d.name=u.keyword,m(d)},n=C(!1),b=r=>{M.confirm("关闭窗口将不会保存所编辑信息，确认关闭吗?").then(()=>{r(),e.$refs.userFormRef.resetFields()}).catch(()=>{})},i=y({name:"",age:"",sex:"",birth:"",addr:""}),V=()=>{e.$refs.userFormRef.validate(async r=>{r?p.value==="add"?await e.$api.addUser(i)&&(e.$refs.userFormRef.resetFields(),n.value=!1,m(d)):(i.sex=i.sex==="男"?0:1,await e.$api.editUser(i)&&(e.$refs.userFormRef.resetFields(),n.value=!1,m(d))):R({showClose:!0,message:"请输入正确的内容",type:"error"})})},U=()=>{e.$refs.userFormRef.resetFields(),n.value=!1},p=C("add");return{userData:h,tableHead:t,paramConfig:d,changePage:v,formInline:u,searchHandler:f,dialogVisible:n,dialogClose:b,formUser:i,onSubmit:V,cancelHandler:U,editHandler:r=>{p.value="edit",n.value=!0,r.sex=r.sex===1?"男":"女",e.$nextTick(()=>{Object.assign(i,r)})},addHandler:()=>{p.value="add",n.value=!0},occupy:p,deleteHandler:r=>{M.confirm("确认永久删除该用户吗？").then(async()=>{await e.$api.deleteUser({id:r.id}),R({showClose:!0,message:"删除成功！",type:"success"}),m(d)}).catch(()=>{})}}}}),P={class:"action-contaienr"},S={class:"table-container"};function T(e,t,h,d,v,m){const u=s("el-button"),f=s("el-input"),n=s("el-form-item"),b=s("el-form"),i=s("el-table-column"),V=s("el-table"),U=s("el-pagination"),p=s("el-col"),g=s("el-row"),w=s("el-option"),H=s("el-select"),r=s("el-date-picker"),c=s("el-dialog");return k(),$(q,null,[F("div",P,[l(u,{type:"primary",onClick:e.addHandler},{default:a(()=>[_("+新增")]),_:1},8,["onClick"]),l(b,{inline:!0,model:e.formInline},{default:a(()=>[l(n,null,{default:a(()=>[l(f,{modelValue:e.formInline.keyword,"onUpdate:modelValue":t[0]||(t[0]=o=>e.formInline.keyword=o),placeholder:"请输入用户名",onKeyup:Y(e.searchHandler,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(n,null,{default:a(()=>[l(u,{type:"primary",onClick:e.searchHandler},{default:a(()=>[_("搜索")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),F("div",S,[l(V,{data:e.userData,style:{width:"100%"},height:"80vh"},{default:a(()=>[(k(!0),$(q,null,K(e.tableHead,o=>(k(),N(i,{key:o.prop,label:o.label,prop:o.prop,width:o.width?o.width:125},null,8,["label","prop","width"]))),128)),l(i,{fixed:"right",label:"操作","min-width":"180"},{default:a(o=>[l(u,{size:"small",onClick:B=>e.editHandler(o.row)},{default:a(()=>[_("编辑")]),_:2},1032,["onClick"]),l(u,{type:"danger",size:"small",onClick:B=>e.deleteHandler(o.row)},{default:a(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(U,{small:"",background:"",layout:"prev, pager, next",total:e.paramConfig.total,class:"mt-4",onCurrentChange:e.changePage},null,8,["total","onCurrentChange"])]),l(c,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=o=>e.dialogVisible=o),title:e.occupy==="add"?"新增用户":"编辑用户",width:"35%","before-close":e.dialogClose},{default:a(()=>[l(b,{inline:!0,model:e.formUser,ref:"userFormRef"},{default:a(()=>[l(g,null,{default:a(()=>[l(p,{span:12},{default:a(()=>[l(n,{label:"姓名",prop:"name",rules:[{required:!0,message:"请输入姓名"}]},{default:a(()=>[l(f,{modelValue:e.formUser.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.formUser.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,{span:12},{default:a(()=>[l(n,{label:"年龄",prop:"age",rules:[{required:!0,message:"请输入年龄"},{type:"number",message:"请输入数字"}]},{default:a(()=>[l(f,{modelValue:e.formUser.age,"onUpdate:modelValue":t[2]||(t[2]=o=>e.formUser.age=o),modelModifiers:{number:!0},placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(g,null,{default:a(()=>[l(p,{span:11},{default:a(()=>[l(n,{label:"性别",prop:"sex",rules:[{required:!0,message:"请选择性别"}]},{default:a(()=>[l(H,{modelValue:e.formUser.sex,"onUpdate:modelValue":t[3]||(t[3]=o=>e.formUser.sex=o),placeholder:"请选择"},{default:a(()=>[l(w,{label:"女",value:"1"}),l(w,{label:"男",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(p,{span:13},{default:a(()=>[l(n,{label:"出生日期",prop:"birth",rules:[{required:!0,message:"请选择出生日期"}]},{default:a(()=>[l(r,{modelValue:e.formUser.birth,"onUpdate:modelValue":t[4]||(t[4]=o=>e.formUser.birth=o),type:"date",label:"出生日期",placeholder:"请选择",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(g,null,{default:a(()=>[l(n,{label:"地址",prop:"addr",rules:[{required:!0,message:"请输入地址"}]},{default:a(()=>[l(f,{modelValue:e.formUser.addr,"onUpdate:modelValue":t[5]||(t[5]=o=>e.formUser.addr=o),type:"textarea",placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{style:{"justify-content":"flex-end"}},{default:a(()=>[l(n,null,{default:a(()=>[l(u,{type:"primary",onClick:e.cancelHandler},{default:a(()=>[_("取消")]),_:1},8,["onClick"]),l(u,{type:"primary",onClick:e.onSubmit},{default:a(()=>[_("确定")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title","before-close"])],64)}const O=I(z,[["render",T]]);export{O as default};
